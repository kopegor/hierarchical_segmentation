# Иерархическая семантическая сегментация с использованием датасета Pascal-Part

Проект реализует модель иерархической семантической сегментации, обученную на датасете Pascal-Part. Цель проекта — сегментировать изображения на различные части человеческого тела с учетом их иерархической структуры, например, верхняя часть тела, нижняя часть тела и конкретные части тела (руки, ноги и т.д.).

## Ключевые особенности

- **Иерархическая сегментация**: Модель сегментирует изображения на различных уровнях, от общего выделения тела на фоне до выделения конкретных частей тела.
- **Пользовательский модуль PyTorch Lightning**: Модульная и расширяемая реализация с использованием PyTorch Lightning.
- **Sota модели для выделения признаков**: Yolov8 для обнаружения положения тела и SAM для первичной сегментации 
- **Fine tuning**: Используются предобученные энкодеры из Segmentation Models PyTorch для более детальной и четкой сегментации.
- **Отслеживание экспериментов**: Интеграция с MLflow для удобного отслеживания экспериментов и управления моделями.

## Установка

Для запуска проекта необходимо установить все требуемые зависимости. Вы можете установить их с помощью `pip`:

```bash
git clone https://github.com/kopegor/hierarchical_segmentation.git
cd hierarchical_segmentation
```

```bash
conda create -n env_qc python=3.10
conda activate env_qc
pip install -r requirements.txt
```

## Запуск сервера mlflow для отслеживания экспериментов
Для отследивания результатов экспериментов необходимо запустить mlflow сервер. Будем использовать `tmux` для поддержки сервера в отдельной сессии.

```bash
tmux new -s mlflow_server

mlflow server --backend-store-uri sqlite:///mlflow.db --default-artifact-root ./lightning_logs --host 0.0.0.0 --port PORT
```

## Обучение модели
Для запуска обучения модели выполните следующую команду:
```bash
python train.py
```
Это запустит процесс обучения, и вы сможете отслеживать прогресс с помощью логов, предоставляемых PyTorch Lightning.

## Архитектура модели

